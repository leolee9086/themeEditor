# themeEditorä½¿ç”¨æ–¹æ³•

## å®‰è£…ï¼š

é€šè¿‡é›†å¸‚å®‰è£…æˆ–è€…é€šè¿‡å‹ç¼©åŒ…å®‰è£…ã€‚

## ä½¿ç”¨ï¼š

æ’ä»¶å¯ç”¨ååº”å½“ä¼šç”Ÿæˆä¸€ä¸ªä¾§è¾¹æ æŒ‰é’®ï¼Œç‚¹å‡»åå°†ä¼šæ‰“å¼€æ’ä»¶çš„ä¸»é¢æ¿ã€‚

### è®¾ç½®é¡¹ç›®è¯´æ˜ï¼š

#### ä¸»é¢˜é…ç½®

ä¸»é¢˜é…ç½®æ–‡ä»¶å’Œäº§å“å‡åªèƒ½åœ¨å¯¹åº”åç§°ä¸»é¢˜ä¸‹å¯ç”¨ã€‚

é…ç½®äº§å“åªèƒ½åœ¨å¯¹åº”åç§°ä¸»é¢˜çš„å¯¹åº”é…ç½®æ–‡ä»¶ä¸‹å¯ç”¨ã€‚

##### å½“å‰ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼š

å¦‚æœä½ ä½¿ç”¨çš„ä¸»é¢˜æä¾›äº†é…ç½®æ–‡ä»¶ï¼Œå°†å¯ä»¥åœ¨æ­¤å¤„é€‰æ‹©ã€‚

ä¸»é¢˜é…ç½®æ–‡ä»¶**ä¸èƒ½åœ¨æ’ä»¶å†…å¢åŠ æˆ–è€…åˆ é™¤**ï¼Œå¦‚æœæœ‰éœ€è¦è‡ªè¡Œä¿®æ”¹çš„ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„é…ç½®æ–‡ä»¶ç¼–å†™æŒ‡å—ã€‚

##### å½“å‰ä¸»é¢˜é…ç½®äº§å“ï¼š

ä¸è¦é—®æˆ‘ä¸ºå•¥å«äº§å“ï¼Œå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå°±éšä¾¿å†™äº†ä¸€ä¸ªåå­—è€Œå·²ã€‚

é…ç½®äº§å“æ˜¯è®¡ç®—ç”Ÿæˆçš„cssæ–‡ä»¶ã€‚

æ¯ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥å¯¹åº”å¤šä¸ªé…ç½®äº§å“ã€‚

#### å…¬å…±é…ç½®

å…¬å…±é…ç½®æ–‡ä»¶åœ¨å„ä¸ªä¸»é¢˜ä¸‹éƒ½ä¼šç”Ÿæ•ˆã€‚

å…¬å…±é…ç½®æ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªï¼Œç›®å‰ä¸æä¾›ç¼–è¾‘åŠŸèƒ½ï¼Œåªèƒ½ä¸Šä¼ ï¼ˆä»…ä»…åœ¨å®‰å…¨ä¸Šæ–‡å†…ï¼‰æˆ–è€…ä¸‹è½½ã€‚

### é…ç½®è¿‡æ»¤

å¯ä»¥ä»¥å…³é”®è¯ã€é…ç½®æºã€åˆ†ç»„ã€é€‰æ‹©å™¨ç­‰å¯¹é…ç½®é¡¹çš„æ˜¾ç¤ºæˆ–è€…ç”Ÿæ•ˆè¿›è¡Œè¿‡æ»¤ã€‚

#### çœŸå®è¿‡æ»¤

æ²¡æœ‰å¼€å¯çœŸå®è¿‡æ»¤æ—¶ï¼Œé…ç½®é¡¹è¿‡æ»¤ä»…ä»…æ˜¯ç•Œé¢æ˜¾ç¤ºæ•ˆæœã€‚

å¼€å¯çœŸå®è¿‡æ»¤åï¼Œåªæœ‰æ˜¾ç¤ºçš„é…ç½®é¡¹ä¼šç”Ÿæ•ˆã€‚

### é…ç½®äº§å“å¯¼å‡º

ä¸»é¢˜é…ç½®äº§ç‰©å’Œå…¬å…±é…ç½®äº§ç‰©å¯ä»¥åˆ†åˆ«ä¸‹è½½ã€‚

å¯ä»¥ç‚¹å‡»ç•Œé¢ä¸Šçš„`+`â€‹ç¬¦å·å¢åŠ é…ç½®äº§å“ã€‚

## é…ç½®æ–‡ä»¶ç¼–å†™è¯´æ˜

### ä¸»é¢˜é…ç½®æ–‡ä»¶

ä¸»é¢˜éœ€è¦åœ¨theme.jsonä¸­å¢åŠ configé¡¹æ¥å¯ç”¨é…ç½®æ–‡ä»¶é€‚é…ã€‚

ä¾‹å¦‚ï¼š

```json
{
	"config":["config.json"]
}
```

æ˜¯ä¸€ä¸ªåˆæ³•çš„é…ç½®æ–‡ä»¶é¡¹å£°æ˜ã€‚

åŒæ ·çš„ï¼š

```json
{
	"config":"config.json"
}
```

ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

å¦‚æœæœ‰å¤šä¸ªé…ç½®æ–‡ä»¶è¯·ä½¿ç”¨ä¸Šé¢çš„å½¢å¼ï¼Œé‡‡ç”¨é€—å·ï¼ˆ`,`â€‹ï¼‰éš”å¼€çš„å­—ç¬¦ä¸²**ä¸ä¼š**è¢«è¯†åˆ«ä¸ºå¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯èƒ½ä¼šé€ æˆé—®é¢˜ã€‚

### å…¬å…±é…ç½®æ–‡ä»¶

å…¬å…±é…ç½®æ–‡ä»¶å…¨éƒ¨ä½äº`**data\storage\petal\themeEditor\commonConfigs**`â€‹æ–‡ä»¶å¤¹é‡Œå†…éƒ¨ã€‚

æš‚æ—¶ä¸æä¾›åˆ é™¤åŠŸèƒ½ã€‚

æ’ä»¶è‡ªå¸¦æœ‰`difaultConfig.js`â€‹é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ¯æ¬¡å¯åŠ¨æ’ä»¶éƒ½ä¼šè¢«é‡å†™ï¼Œä¸è¦åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå†™ä½ è‡ªå·±éœ€è¦çš„é…ç½®ã€‚

### é…ç½®æ–‡ä»¶æ ¼å¼

é…ç½®æ–‡ä»¶æ¥å—`.json`â€‹ä¸`.js`â€‹æ–‡ä»¶æ ¼å¼ã€‚

å¯ä»¥ä½¿ç”¨å¯¹è±¡æˆ–è€…æ•°ç»„æ¥å£°æ˜é…ç½®è§„åˆ™

è¿™æ˜¯ä¸€ä¸ªåˆæ³•çš„é…ç½®æ–‡ä»¶

```js
[
  {
    "name": "--b3-theme-background",
    "type": "color",
    "label": "èƒŒæ™¯è‰²",
    "memo": "",
    "default":"red"//defaulté¡¹ç¼ºçœæ—¶ä¼šå°è¯•ä»ç›¸å…³cssæ–‡ä»¶è§£æ
  }
]
```

ç­‰ä»·äºï¼š

```js
{
   "--b3-theme-background":{
    "type": "color",
    "label": "èƒŒæ™¯è‰²",
    "memo": "",
    "default":"red"
  }
}
```

ä½¿ç”¨jså£°æ˜é…ç½®æ–‡ä»¶æ—¶,ä»…æ”¯æŒ`esm`â€‹,å¹¶è¯·å°†é…ç½®è§„åˆ™ä»¥`default`â€‹å¯¼å‡º,ä¾‹å¦‚:

```js
let ç³»ç»Ÿå­—ä½“åˆ—è¡¨ =(await((await fetch(
    '/api/system/getSysFonts',
    {
        method:'post',
        body:'{}'
    }
)).json())).data

export default {
    "--b3-font-family":{
        label:'å­—ä½“æ ·å¼',
        type:'select',
        multiple:true,
        options:ç³»ç»Ÿå­—ä½“åˆ—è¡¨,
        subtype:"fonts"
    },
    "--b3-theme-background":{
        label:'èƒŒæ™¯è‰²',
        type:'color',
      
    }
}
```

> ä¸ºäº†ä½ çš„èº«å¿ƒå¥åº·è€ƒè™‘ï¼Œè¯·**ä¸è¦**ä½¿ç”¨å®ƒä½œä¸º`theme.js`â€‹çš„æ›¿ä»£ã€‚

### é…ç½®é¡¹ç›®è¯´æ˜

é…ç½®é¡¹ç›®å‰å¯ä»¥å£°æ˜çš„`type`â€‹æœ‰è¿™äº›

* string:ä¸€ä¸ªå­—ç¬¦ä¸²
* colorï¼šé¢œè‰²

  * æ¥å—å„ç§æ ¼å¼çš„é¢œè‰²ï¼Œä½†æ˜¯è¾“å‡ºä¸ºrgba
* numberï¼šæ•°å­—

  * maxï¼šæœ€å¤§å€¼
  * minï¼šæœ€å°å€¼
  * unitï¼š å•ä½ï¼Œé»˜è®¤ä¸ºpx
* selectï¼šé€‰æ‹©å™¨

  * subtypeä¸ºfontæ—¶ä¼šè‡ªè¡Œæ¸²æŸ“å­—ä½“æ ·å¼
  * multipleå±æ€§æŒ‡å®šæ˜¯å¦å¤šé¡¹é€‰æ‹©
* booleanï¼šå¸ƒå°”å€¼

å…¶ä»–å±æ€§æœ‰ï¼š

* nameï¼šå±æ€§åç§°ï¼Œä½¿ç”¨csså†™æ³•ï¼Œä¸è¦ä½¿ç”¨é©¼å³°å‘½åï¼Œä¾‹å¦‚`background-color`â€‹â€‹â€‹ä¸è¦å†™ä½œ`backgroundColor`â€‹â€‹â€‹ã€‚
* labelï¼šæ˜¾ç¤ºä½œä¸ºé…ç½®é¡¹è¯´æ˜æ–‡å­—ã€‚
* groupï¼šåˆ†ç»„
* selectorï¼šé…ç½®é¡¹çš„ç›®æ ‡é€‰æ‹©å™¨ï¼Œé»˜è®¤ä¸º`:root`â€‹ï¼ˆä¾¿äºç”¨æ¥å£°æ˜csså˜é‡ï¼‰
* subGroupï¼šæ¬¡çº§åˆ†ç»„
* memoï¼šå¤‡ç”¨å±æ€§
* renderï¼šå¦‚æœéœ€è¦ä½¿ç”¨è‡ªå®šä¹‰æ¸²æŸ“å‡½æ•°ï¼Œè¯·å°†`type`â€‹â€‹å±æ€§ç•™ç©ºï¼š

  * ```js
     {
        name: "background-color",
        //type: "color",
        label: "äºŒçº§æ ‡é¢˜é¢œè‰²",
        memo: "",
        group: "ç¼–è¾‘å™¨",
        subGroup:"æ ‡é¢˜",
        selector:" div.protyle-wysiwyg.protyle-wysiwyg--attr > div.h2",
        render:(options)=>{
          let element = document.createElement('input')
          return element
        }
      }
    ```
  * æ¸²æŸ“ä¸ºï¼š

    * â€‹![image](assets/image-20230519162400-0alp2l7.png)â€‹
  * å¦‚æœä½¿ç”¨æ¸²æŸ“å‡½æ•°ï¼Œéœ€è¦ä¿è¯ï¼š

    * 1. è¿”å›å€¼ä¸ºä¸€ä¸ªDOMå…ƒç´ 
      2. è¿™ä¸ªå…ƒç´ å¿…é¡»åœ¨å€¼æ”¹å˜æ—¶è§¦å‘changeäº‹ä»¶
  * å¦å¤–ï¼š

    * æ¸²æŸ“å‡½æ•°ä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºå£°æ˜è§„åˆ™è‡ªèº«ä»¥åŠæ‰€åœ¨çš„è¡¨å•é¡¹ã€‚
    * è¡¨å•é¡¹çš„DOMå¯ä»¥é€šè¿‡`formItem.element`â€‹â€‹æ¥ä¿®æ”¹ï¼Œä½†å³ä½¿å¦‚æ­¤ï¼Œä½ ä¾ç„¶è¦è¿”å›ä¸€ä¸ªè¾“å…¥å…ƒç´ ï¼Œå¹¶ä¿è¯å®ƒçš„å€¼æ”¹å˜æ—¶è§¦å‘`change`â€‹â€‹äº‹ä»¶

### csså˜é‡

å½“å£°æ˜çš„å€¼ä¸ºä¸€ä¸ªcsså˜é‡æ—¶ï¼Œè°ƒèŠ‚è¿™ä¸ªå±æ€§å°†ä¼šç›´æ¥æ”¹åŠ¨å¯¹åº”é€‰æ‹©å™¨å†…çš„csså˜é‡å£°æ˜ï¼Œè€Œä¸æ˜¯æ”¹åŠ¨`name`â€‹å¯¹åº”çš„csså±æ€§å€¼ã€‚

## æ„Ÿè°¢ï¼š

pickrï¼š[Simonwep/pickr: ğŸ¨ Flat, simple, multi-themed, responsive and hackable Color-Picker library. No dependencies, no jQuery. Compatible with all CSS Frameworks e.g. Bootstrap, Materialize. Supports alpha channel, rgba, hsla, hsva and more! (github.com)](https://github.com/Simonwep/pickr)

â€‹â€‹libarchivejsâ€‹ï¼š[nika-begiashvili/libarchivejs: Archive library for browsers (github.com)](https://github.com/nika-begiashvili/libarchivejs)

## æèµ ï¼š

å¦‚æœå®ƒå¯¹ä½ æœ‰ç”¨ï¼Œå¯ä»¥ç»™æˆ‘ä¹°ä¸€æ¯å’–å•¡

[leolee9086æ­£åœ¨åˆ›ä½œä¸€äº›ç®€å•çš„æŠ€æœ¯æ•™ç¨‹å’Œå°å·¥å…·,ä»¥åŠè®¾è®¡æ–¹é¢å†…å®¹ | çˆ±å‘ç”µ (afdian.net)](https://afdian.net/a/leolee9086)

æˆ‘å¯¹GitHubä½¿ç”¨ä¸å¤ªç†Ÿæ‚‰ï¼Œå¹³æ—¶ä¹Ÿæœ‰å…¶ä»–å·¥ä½œè¦åšï¼Œå¦‚æœæ²¡æœ‰åŠæ—¶å›å¤issueè¿˜è¯·è§è°…ã€‚